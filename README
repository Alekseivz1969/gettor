OVERVIEW
--------
GetTor is a program for serving Tor and Tor related files over SMTP.
Users interface with GetTor by sending it an email. The users must use a mail
server that signs outgoing mail with DKIM or have their email address added 
to the whitelist. This is to prevent abuse. The following document explains 
how to setup GetTor for a server admin.

To use GetTor, you'll want a machine that invokes .forward files for users.
You'll also want to have python and rsync installed.

There some limits with smtp software for outgoing email sizes. You should 
check with your software to ensure that you can send files that are as large
as the largest files Tor distributes. For postfix, you may want to have a line
that looks like the following in /etc/postfix/main.cf:

    message_size_limit = 30360000

In Exim, the default message size is now 50MB, which should be sufficient. The
value is also adaptable through the config file paramter 'message_size_limit'
in case you need to.

You will want to ensure that you have a properly configured set 
of mo files for each translation. Generate and install mo files as follows:

   GetTor.py -r

As an example, for the user 'gettor' we will setup GetTor.py like so:

Configure the default ~/.gettorrc file:

    gettor@moria:~$ cat .gettorrc 
    [global]
    stateDir    = /home/gettor/gettor/state/
    blStateDir  = /home/gettor/gettor/bl/
    wlStateDir  = /home/gettor/gettor/wl/
    distDir     = /home/gettor/gettor/distdir/
    packDir     = /home/gettor/gettor/packdir/
    locale        = en
    logSubSystem= stdout
    logFile     = /home/gettor/gettor/logs/logfile
    localeDir   =  /home/gettor/gettor/i18n/

Your .forward file should look like this:

    gettor@moria:~$ cat .forward 
    "|/home/gettor/bin/GetTor.py"

These are the python files we need to run GetTor.py:

    gettor@moria:~/bin$ ls
    dkim.py              gettor_log.py       gettor.py
    gettor_blacklist.py  gettor_opt.py       gettor_requests.py
    gettor_config.py     gettor_packages.py  gettor_responses.py

Once you have everything installed, you'll want to initalize the file store:

    gettor@moria:~/newbin$ ./gettor.py -f -p

You should see an rsync and finally something like:

    sent 1637 bytes  received 415792532 bytes  9558486.64 bytes/sec
    total size is 415735925  speedup is 1.00
    2009-01-05 16:49:29,226 (9222) Syncing Tor packages done.
    2009-01-05 16:49:30,155 (9222) Building packages done.

Now you'll install the cronjob. This clears the blacklist and updates 
packages daily:

    gettor@moria:~/bin$ ./GetTor.py -i
    2009-01-05 17:34:53,911 (16646) Installing cron done.

Now GetTor.py is installed, prepared and ready to serve files. Send it email!

TRANSLATION FILES
-----------------
Provided there is a working locale environment, GetTor will compile and setup
locale files for you as follows:

    gettor@moria:~/bin$ ./GetTor.py -r
    2009-01-08 12:18:09,041 (19287) Installing translation files done.

You can also configure the .mo files to live in another place by telling GetTor
so in the config file, for example:

    localeDir = /home/gettor/gettor/i18n

This will result in GetTor expected the english .mo file in the directory

    /home/gettor/gettor/i18n/en/LC_MESSAGES/gettor.mo

Also, in case your .po files for some reason live in a different directory 
than i18n/ (relative to GetTor.py, as provided by GetTor), you can tell this
to GetTor as follows:

    gettor@moria:~/bin$ ./GetTor.py -r -d /path/to/my/mofiles/directory

Note that GetTor will expect the same directory structure as provided under
i18n/ in the GetTor source package, e.g. 'i18n/en/gettor_en.po', 
'i18n/de/gettor_de.po' and so on.

CONFIGURATION
-------------
A proper GetTor configuration file is expected in the user's home directory 
and should look like this:

    [global]
    stateDir    = /home/gettor/gettor/state/
    blStateDir  = /home/gettor/gettor/bl/
    wlStateDir  = /home/gettor/gettor/wl/
    distDir     = /home/gettor/gettor/distdir/
    packDir     = /home/gettor/gettor/packdir/
    locale      = en
    logSubSystem= stdout
    logFile     = /home/gettor/gettor/logs/logfile
    localeDir   =  /home/gettor/gettor/i18n/

Note that you can set from none to any of these values in your config file.
Values you dont provide will be taken from defaults.

Here is what each of them is used for individually:

blStateDir:    Blacklisted (hashed) email addresses go here
wlStateDir:    Whitelisted (hashed) email addresses go here
distDir:       Prestine Tor packages as downloaded by rsync will be found here
packDir:       Processed Tor packages ready to be handed out to the user will
               be found here
srcEmail:      The email containing the Tor package will use this as 'From:'
locale:        Choose your default mail and log locale
logFile:       If 'file' logging is chosen, log to this file
logSubSystem:  This has to be one of the following strings:
               'nothing':  Nothing is logged anywhere (Recommended)
               'stdout':   Log to stdout
               'syslog':   Logmessages will be written to syslog
               'file':     Logmessages will be written to a file (Not that 
                           this needs the 'logFile' option in the config file
                           also set to something useful
localeDir:     This is where the 'en/LC_MESSAGES/gettor.mo' or 
               'whateverlang/LC_MESSAGES/gettor.mo' should go


